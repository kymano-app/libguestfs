94d93
< #include <sys/select.h>
102a102,103
> #define O_NOCTTY 0
> 
465c466
<     if (pipe2 (errorfd, O_CLOEXEC) == -1) {
---
>     if (pipe2 (errorfd, O_NOINHERIT) == -1) {
473c474
<     if (pipe2 (outfd, O_CLOEXEC) == -1) {
---
>     if (pipe2 (outfd, O_NOINHERIT) == -1) {
565c566
<     max_fd = sysconf (_SC_OPEN_MAX);
---
>     max_fd = -1;
810c811
<   if (pipe2 (fd, O_CLOEXEC) == -1) {
---
>   if (pipe2 (fd, O_NOINHERIT) == -1) {
823c824
<                 O_WRONLY|O_CREAT|O_NOCTTY|O_TRUNC|O_CLOEXEC, 0600);
---
>                 O_WRONLY|O_CREAT|O_NOCTTY|O_TRUNC|O_NOINHERIT, 0600);
