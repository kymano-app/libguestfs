94d93
< #include <sys/select.h>
102a102,103
> #define O_NOCTTY 0
> 
465c466
<     if (pipe2 (errorfd, O_CLOEXEC) == -1) {
---
>     if (pipe2 (errorfd, O_NOINHERIT) == -1) {
473c474
<     if (pipe2 (outfd, O_CLOEXEC) == -1) {
---
>     if (pipe2 (outfd, O_NOINHERIT) == -1) {
541d541
<   struct sigaction sa;
554,560d553
<   memset (&sa, 0, sizeof sa);
<   sa.sa_handler = SIG_DFL;
<   sa.sa_flags = 0;
<   sigemptyset (&sa.sa_mask);
<   for (i = 1; i < NSIG; ++i)
<     sigaction (i, &sa, NULL);
< 
810c803
<   if (pipe2 (fd, O_CLOEXEC) == -1) {
---
>   if (pipe2 (fd, O_NOINHERIT) == -1) {
823c816
<                 O_WRONLY|O_CREAT|O_NOCTTY|O_TRUNC|O_CLOEXEC, 0600);
---
>                 O_WRONLY|O_CREAT|O_NOCTTY|O_TRUNC|O_NOINHERIT, 0600);
