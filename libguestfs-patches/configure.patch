--- .//configure	2021-12-24 10:46:19.000000000 +0100
+++ .//configure_new	2022-01-23 22:46:27.000000000 +0100
@@ -764,9 +764,7 @@
 ounit_is_v2
 OCAML_PKG_ounit2
 OCAML_PKG_gettext
-HIVEX_OPEN_UNSAFE_FLAG
 CAMLRUN
-OCAML_PKG_hivex
 OCAMLDEP_ONE_LINE
 OCAMLDEP_ALL
 OCAML_RUNTIME_VARIANT_PIC_OPTION
@@ -821,10 +819,6 @@
 SD_JOURNAL_CFLAGS
 LIBRPM_LIBS
 LIBRPM_CFLAGS
-HAVE_HIVEX_FALSE
-HAVE_HIVEX_TRUE
-HIVEX_LIBS
-HIVEX_CFLAGS
 CAP_LIBS
 ACL_LIBS
 INSTALL_DAEMON_FALSE
@@ -1133,8 +1127,6 @@
 CXXCPP
 FUSE_CFLAGS
 FUSE_LIBS
-HIVEX_CFLAGS
-HIVEX_LIBS
 LIBRPM_CFLAGS
 LIBRPM_LIBS
 SD_JOURNAL_CFLAGS
@@ -25202,98 +25194,6 @@
 
 
 pkg_failed=no
-{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for HIVEX" >&5
-printf %s "checking for HIVEX... " >&6; }
-
-if test -n "$HIVEX_CFLAGS"; then
-    pkg_cv_HIVEX_CFLAGS="$HIVEX_CFLAGS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
-    { { printf "%s\n" "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"hivex\""; } >&5
-  ($PKG_CONFIG --exists --print-errors "hivex") 2>&5
-  ac_status=$?
-  printf "%s\n" "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; }; then
-  pkg_cv_HIVEX_CFLAGS=`$PKG_CONFIG --cflags "hivex" 2>/dev/null`
-		      test "x$?" != "x0" && pkg_failed=yes
-else
-  pkg_failed=yes
-fi
- else
-    pkg_failed=untried
-fi
-if test -n "$HIVEX_LIBS"; then
-    pkg_cv_HIVEX_LIBS="$HIVEX_LIBS"
- elif test -n "$PKG_CONFIG"; then
-    if test -n "$PKG_CONFIG" && \
-    { { printf "%s\n" "$as_me:${as_lineno-$LINENO}: \$PKG_CONFIG --exists --print-errors \"hivex\""; } >&5
-  ($PKG_CONFIG --exists --print-errors "hivex") 2>&5
-  ac_status=$?
-  printf "%s\n" "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
-  test $ac_status = 0; }; then
-  pkg_cv_HIVEX_LIBS=`$PKG_CONFIG --libs "hivex" 2>/dev/null`
-		      test "x$?" != "x0" && pkg_failed=yes
-else
-  pkg_failed=yes
-fi
- else
-    pkg_failed=untried
-fi
-
-
-
-if test $pkg_failed = yes; then
-   	{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
-printf "%s\n" "no" >&6; }
-
-if $PKG_CONFIG --atleast-pkgconfig-version 0.20; then
-        _pkg_short_errors_supported=yes
-else
-        _pkg_short_errors_supported=no
-fi
-        if test $_pkg_short_errors_supported = yes; then
-	        HIVEX_PKG_ERRORS=`$PKG_CONFIG --short-errors --print-errors --cflags --libs "hivex" 2>&1`
-        else
-	        HIVEX_PKG_ERRORS=`$PKG_CONFIG --print-errors --cflags --libs "hivex" 2>&1`
-        fi
-	# Put the nasty error message in config.log where it belongs
-	echo "$HIVEX_PKG_ERRORS" >&5
-
-	{ { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-printf "%s\n" "$as_me: error: in \`$ac_pwd':" >&2;}
-as_fn_error $? "hivex library is required
-See \`config.log' for more details" "$LINENO" 5; }
-elif test $pkg_failed = untried; then
-     	{ printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
-printf "%s\n" "no" >&6; }
-	{ { printf "%s\n" "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
-printf "%s\n" "$as_me: error: in \`$ac_pwd':" >&2;}
-as_fn_error $? "hivex library is required
-See \`config.log' for more details" "$LINENO" 5; }
-else
-	HIVEX_CFLAGS=$pkg_cv_HIVEX_CFLAGS
-	HIVEX_LIBS=$pkg_cv_HIVEX_LIBS
-        { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: yes" >&5
-printf "%s\n" "yes" >&6; }
-
-
-
-
-printf "%s\n" "#define HAVE_HIVEX 1" >>confdefs.h
-
-
-fi
- if test "x$HIVEX_LIBS" != "x"; then
-  HAVE_HIVEX_TRUE=
-  HAVE_HIVEX_FALSE='#'
-else
-  HAVE_HIVEX_TRUE='#'
-  HAVE_HIVEX_FALSE=
-fi
-
-
-
-pkg_failed=no
 { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for LIBRPM" >&5
 printf %s "checking for LIBRPM... " >&6; }
 
@@ -28022,88 +27922,6 @@
 fi
 
 
-have_Hivex_OPEN_UNSAFE=no
-if test "x$enable_daemon" = "xyes"; then
-    OCAML_PKG_hivex=no
-
-  { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for OCaml findlib package hivex" >&5
-printf %s "checking for OCaml findlib package hivex... " >&6; }
-
-  unset found
-  unset pkg
-  found=no
-  for pkg in hivex  ; do
-    if $OCAMLFIND query $pkg >/dev/null 2>/dev/null; then
-      { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: found" >&5
-printf "%s\n" "found" >&6; }
-      OCAML_PKG_hivex=$pkg
-      found=yes
-      break
-    fi
-  done
-  if test "$found" = "no" ; then
-    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: not found" >&5
-printf "%s\n" "not found" >&6; }
-    OCAML_PKG_hivex=no
-  fi
-
-
-
-    if test "x$OCAML_PKG_hivex" = "xno"; then
-        as_fn_error $? "the OCaml module 'hivex' is required" "$LINENO" 5
-    fi
-
-    # Check if Hivex has 'OPEN_UNSAFE' flag.
-    { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking for Hivex.OPEN_UNSAFE" >&5
-printf %s "checking for Hivex.OPEN_UNSAFE... " >&6; }
-    rm -f conftest.ml
-    echo 'let s = Hivex.OPEN_UNSAFE' > conftest.ml
-    if $OCAMLFIND ocamlc -package hivex -c conftest.ml >&5 2>&5 ; then
-        { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: yes" >&5
-printf "%s\n" "yes" >&6; }
-        have_Hivex_OPEN_UNSAFE=yes
-    else
-        { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: no" >&5
-printf "%s\n" "no" >&6; }
-        have_Hivex_OPEN_UNSAFE=no
-    fi
-
-                { printf "%s\n" "$as_me:${as_lineno-$LINENO}: checking which OCaml runtime we should link the daemon with" >&5
-printf %s "checking which OCaml runtime we should link the daemon with... " >&6; }
-    if test "x$OCAMLOPT" != "xno"; then
-        for f in asmrun_pic asmrun; do
-            if test -f "$OCAMLLIB/lib$f.a"; then
-                CAMLRUN=$f
-                break
-            fi
-        done
-    else
-        for f in camlrun; do
-            if test -f "$OCAMLLIB/lib$f.a"; then
-                CAMLRUN=$f
-                break
-            fi
-        done
-    fi
-    if test "x$CAMLRUN" != "x"; then
-        { printf "%s\n" "$as_me:${as_lineno-$LINENO}: result: $CAMLRUN" >&5
-printf "%s\n" "$CAMLRUN" >&6; }
-    else
-        as_fn_error $? "could not find or link to libasmrun or libcamlrun" "$LINENO" 5
-    fi
-
-fi
-
-if test "x$have_Hivex_OPEN_UNSAFE" = "xno"
-then :
-
-    HIVEX_OPEN_UNSAFE_FLAG="None"
-
-else $as_nop
-
-    HIVEX_OPEN_UNSAFE_FLAG="Some Hivex.OPEN_UNSAFE"
-
-fi
 
 
 OCAML_PKG_gettext=no
@@ -31388,7 +31206,7 @@
 ac_config_files="$ac_config_files run"
 
 
-ac_config_files="$ac_config_files Makefile appliance/Makefile bash/Makefile bundled/ocaml-augeas/Makefile common/errnostring/Makefile common/edit/Makefile common/mlgettext/Makefile common/mlpcre/Makefile common/mlstdutils/Makefile common/mlstdutils/guestfs_config.ml common/mlutils/Makefile common/options/Makefile common/parallel/Makefile common/progress/Makefile common/protocol/Makefile common/qemuopts/Makefile common/structs/Makefile common/utils/Makefile common/visit/Makefile common/windows/Makefile config.sh csharp/Makefile daemon/daemon_config.ml daemon/Makefile docs/Makefile erlang/Makefile erlang/examples/Makefile examples/Makefile fish/Makefile fuse/Makefile generator/Makefile gnulib/lib/Makefile gobject/libguestfs-gobject-1.0.pc gobject/Makefile golang/Makefile golang/examples/Makefile haskell/Makefile include/Makefile java/Makefile java/examples/Makefile lib/Makefile lib/libguestfs.pc lib/local/libguestfs.pc lua/Makefile lua/examples/Makefile ocaml/META ocaml/Makefile ocaml/examples/Makefile perl/Build.PL perl/Makefile perl/examples/Makefile php/Makefile po-docs/Makefile po-docs/ja/Makefile po-docs/uk/Makefile po/Makefile python/Makefile python/examples/Makefile python/setup.py python/t/tests_helper.py rescue/Makefile ruby/Makefile ruby/Rakefile ruby/examples/Makefile ruby/ext/guestfs/extconf.rb rust/Makefile rust/Cargo.toml test-data/Makefile test-data/binaries/Makefile test-data/blank-disks/Makefile test-data/files/Makefile test-data/phony-guests/Makefile test-data/phony-guests/guests.xml test-tool/Makefile tests/Makefile tests/daemon/captive-daemon.pm tests/disks/test-qemu-drive-libvirt.xml website/index.html"
+ac_config_files="$ac_config_files Makefile appliance/Makefile bash/Makefile bundled/ocaml-augeas/Makefile common/errnostring/Makefile common/edit/Makefile common/mlgettext/Makefile common/mlpcre/Makefile common/mlstdutils/Makefile common/mlstdutils/guestfs_config.ml common/mlutils/Makefile common/options/Makefile common/parallel/Makefile common/progress/Makefile common/protocol/Makefile common/qemuopts/Makefile common/structs/Makefile common/utils/Makefile common/visit/Makefile common/windows/Makefile config.sh csharp/Makefile daemon/daemon_config.ml daemon/Makefile docs/Makefile erlang/Makefile erlang/examples/Makefile examples/Makefile fish/Makefile fuse/Makefile generator/Makefile gnulib/lib/Makefile gobject/libguestfs-gobject-1.0.pc gobject/Makefile golang/Makefile golang/examples/Makefile haskell/Makefile include/Makefile java/Makefile java/examples/Makefile lib/Makefile lib/libguestfs.pc lib/local/libguestfs.pc lua/Makefile lua/examples/Makefile ocaml/META ocaml/Makefile ocaml/examples/Makefile perl/Build.PL perl/Makefile perl/examples/Makefile php/Makefile po-docs/Makefile po-docs/ja/Makefile po-docs/uk/Makefile po/Makefile python/Makefile python/examples/Makefile python/setup.py python/t/tests_helper.py rescue/Makefile ruby/Makefile ruby/Rakefile ruby/examples/Makefile ruby/ext/guestfs/extconf.rb rust/Makefile rust/Cargo.toml test-data/Makefile test-data/binaries/Makefile test-data/blank-disks/Makefile test-data/files/Makefile test-data/phony-guests/Makefile test-data/phony-guests/guests.xmltests/Makefile website/index.html"
 
 
 cat >confcache <<\_ACEOF
@@ -31568,10 +31386,6 @@
   as_fn_error $? "conditional \"INSTALL_DAEMON\" was never defined.
 Usually this means the macro was only invoked conditionally." "$LINENO" 5
 fi
-if test -z "${HAVE_HIVEX_TRUE}" && test -z "${HAVE_HIVEX_FALSE}"; then
-  as_fn_error $? "conditional \"HAVE_HIVEX\" was never defined.
-Usually this means the macro was only invoked conditionally." "$LINENO" 5
-fi
 if test -z "${ENABLE_APPLIANCE_TRUE}" && test -z "${ENABLE_APPLIANCE_FALSE}"; then
   as_fn_error $? "conditional \"ENABLE_APPLIANCE\" was never defined.
 Usually this means the macro was only invoked conditionally." "$LINENO" 5
@@ -32746,10 +32560,6 @@
     "test-data/files/Makefile") CONFIG_FILES="$CONFIG_FILES test-data/files/Makefile" ;;
     "test-data/phony-guests/Makefile") CONFIG_FILES="$CONFIG_FILES test-data/phony-guests/Makefile" ;;
     "test-data/phony-guests/guests.xml") CONFIG_FILES="$CONFIG_FILES test-data/phony-guests/guests.xml" ;;
-    "test-tool/Makefile") CONFIG_FILES="$CONFIG_FILES test-tool/Makefile" ;;
-    "tests/Makefile") CONFIG_FILES="$CONFIG_FILES tests/Makefile" ;;
-    "tests/daemon/captive-daemon.pm") CONFIG_FILES="$CONFIG_FILES tests/daemon/captive-daemon.pm" ;;
-    "tests/disks/test-qemu-drive-libvirt.xml") CONFIG_FILES="$CONFIG_FILES tests/disks/test-qemu-drive-libvirt.xml" ;;
     "website/index.html") CONFIG_FILES="$CONFIG_FILES website/index.html" ;;
 
   *) as_fn_error $? "invalid argument: \`$ac_config_target'" "$LINENO" 5;;
